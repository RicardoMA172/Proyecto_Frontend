<header class="topbar" *ngIf="isAuthenticated">
  <!-- Toggle placed at the left edge of the header -->
  <button class="toggle" (click)="toggleSidebar()">‚ò∞</button>
  <!-- Brand (logo + title) placed right of the toggle. Do not change the toggle button. -->
  <div class="header-brand">
    <img src="assets/logo.png" alt="logo" class="topbar-logo" />
    <span class="topbar-title">{{ title() }}</span>
  </div>
  <div class="topbar-right">
    <div class="settings-wrapper">
      <button class="settings-btn" [class.active]="showSettings" (click)="toggleSettings()" aria-haspopup="true" aria-expanded="{{showSettings}}" aria-label="Configuraci√≥n">
        <!-- Minimal gear SVG (stroke uses currentColor) -->
        <svg class="settings-icon" viewBox="0 0 24 24" width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
          <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" />
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09c.7 0 1.28-.42 1.51-1a1.65 1.65 0 0 0-.33-1.82l-.06-.06A2 2 0 0 1 6.7 2.7l.06.06c.45.45 1.08.62 1.66.45.5-.14 1.05-.14 1.55 0 .58.17 1.21 0 1.66-.45l.06-.06A2 2 0 0 1 13.8 2.7l-.06.06c-.45.45-.62 1.08-.45 1.66.14.5.14 1.05 0 1.55-.17.58 0 1.21.45 1.66l.06.06a2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33c.5-.17 1.08 0 1.4.33z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
      <div class="settings-panel" *ngIf="showSettings">
        <button class="settings-item" (click)="openProfileFromSettings()">Ver perfil</button>
        <button class="settings-item" (click)="logout()">Cerrar sesi√≥n</button>
      </div>
    </div>
  </div>
  <div class="profile-panel" *ngIf="showProfile" style="position: fixed !important; top: 64px !important; right: 24px !important; z-index: 2147483647 !important; background: #2b3036 !important; color: #eef2f5 !important; font-family: Roboto, system-ui, Arial, sans-serif !important;">
    <div class="profile-row"><strong>Nombre:</strong> {{ userProfile?.name }}</div>
    <div class="profile-row"><strong>Email:</strong> {{ userProfile?.email }}</div>
  </div>

</header>

<!-- Overlay para cuando la sidebar est√° abierta en pantallas peque√±as -->
<div class="overlay" (click)="toggleSidebar()" [class.show]="!sidebarClosed"></div>

<div class="layout">
  <nav *ngIf="showSidebar" class="sidebar" [class.closed]="sidebarClosed">
    <div class="sidebar-header">
      <div class="brand" *ngIf="!sidebarClosed"></div>
    </div>

    <ul class="menu">
  <li><a routerLink="/" data-short="üè†" (click)="onMenuClick()"><span>Inicio</span></a></li>
  <li><a routerLink="/temp" data-short="TEMP" (click)="onMenuClick()"><span>Temperatura</span></a></li>
  <li><a routerLink="/hum" data-short="HUM" (click)="onMenuClick()"><span>Humedad</span></a></li>
  <li><a routerLink="/amon" data-short="NH3" (click)="onMenuClick()"><span>Amon√≠aco (NH3)</span></a></li>
  <li><a routerLink="/co" data-short="CO" (click)="onMenuClick()"><span>Mon√≥xido de Carbono (CO)</span></a></li>
  <li><a routerLink="/nox" data-short="NOx" (click)="onMenuClick()"><span>√ìxidos de Nitr√≥geno (NOx)</span></a></li>
  <li><a routerLink="/sox" data-short="SOx" (click)="onMenuClick()"><span>√ìxidos de Azufre (SOx)</span></a></li>
  <li><a routerLink="/pm10" data-short="pm10" (click)="onMenuClick()"><span>Part√≠culas PM10</span></a></li>
  <li><a routerLink="/pm25" data-short="pm2.5" (click)="onMenuClick()"><span>Part√≠culas PM2.5</span></a></li>
    </ul>
  </nav>

  <main class="content">
    <router-outlet></router-outlet>
  </main>
</div>
