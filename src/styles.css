/* Global layout variables and rules - estos deben ser globales porque afectan a <body>
   y al layout completo; mover aqu√≠ evita que queden encapsulados por estilos de
   componentes y por eso el header fijo no tapar√° el contenido. */
:root {
  --topbar-height: 78px;
}

/* Reset general */
* {
  box-sizing: border-box;
}

/* Evitar scroll global del navegador */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  /* Permitir scroll nativo por defecto. El contenedor principal `.content` seguir√°
     manejando el scroll interno en escritorio; en dispositivos t√°ctiles activamos
     el momentum scrolling m√°s abajo. */
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  touch-action: auto;
}

/* Reservar el espacio del topbar fijo para que no tape el contenido */
body {
  padding-top: var(--topbar-height);
  overflow-x: hidden; /* üîí evita scroll lateral del body */
  font-family: "Roboto", system-ui, Arial, sans-serif;
  background: var(--bg, #ecf0f1);
  color: var(--text, #2c3e50);
}

/* El `.layout` ocupa la altura restante de la ventana (viewport - topbar) */
.layout {
  height: calc(100vh - var(--topbar-height));
  display: flex;
  align-items: stretch;
  overflow: hidden; /* üîí evita scroll adicional en layout */
}

/* Sidebar */
.sidebar {
  height: 100%;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Forzar que el content use toda la altura disponible dentro del layout */
.content {
  flex: 1;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow-y: auto; /* ‚úÖ solo aqu√≠ permitimos scroll vertical */
  overflow-x: auto; /* ‚úÖ si el contenido excede horizontalmente */
}

/* End global layout rules */

/* Responsive helpers y utilidades globales */
:root{
  --container-max-width: 1200px;
}

.container{
  max-width: var(--container-max-width);
  margin: 0 auto;
  padding: 0 1rem;
  box-sizing: border-box;
}

img, video, canvas { max-width: 100%; height: auto; display: block; }

.table-responsive { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }

/* En pantallas peque√±as permitimos scroll global (anulamos overflow:hidden del body) */
@media (max-width: 800px) {
  html, body { overflow: auto; }
  /* Evitar que el layout corte el contenido en dispositivos peque√±os */
  .layout { height: auto; min-height: calc(100vh - var(--topbar-height)); display:block; }
}

/* ------- moved from app.css: responsive helpers for records, tables, date bar and charts ------- */
.records-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}
.records-header h2 { margin: 0; font-size: 1.25rem; }

.records-section .records-table,
.records-section table { width: 100%; border-collapse: collapse; }
.records-section .records-table { display: table; }
.records-section { overflow: hidden; }
.records-section .records-table { display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; touch-action: auto; overscroll-behavior: contain; }
.records-section .records-table thead, .records-section .records-table tbody, .records-section .records-table tr { display: table; width: 100%; table-layout: fixed; }

.date-bar-container { display: flex; align-items: center; gap: 8px; margin-top: 18px; flex-wrap: nowrap; }
.date-bar { display: flex; gap: 8px; overflow-x: auto; -webkit-overflow-scrolling: touch; touch-action: pan-x; }
.date-bar button { white-space: nowrap; padding: 6px 10px; border-radius: 6px; border: 1px solid rgba(0,0,0,0.06); background: #fff; cursor: pointer; }
.date-bar button.selected, .date-bar button.selected:hover { background: var(--accent); color: #fff; border-color: transparent; }
.arrow-button { width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; border-radius: 6px; border: 1px solid rgba(0,0,0,0.08); background: #fff; cursor: pointer; }

.chart-section { width: 100%; max-width: 100%; }
.chart-section canvas { width: 100% !important; height: auto !important; display: block; touch-action: auto; }

/* Enable momentum scrolling and vertical pan for main content to improve single-swipe behavior on touch devices */
.content { -webkit-overflow-scrolling: touch; touch-action: pan-y; }

/* For any full-width wrappers that should scroll vertically */
.records-section, .stats-section, .chart-section { touch-action: pan-y; }

@media (max-width: 800px) {
  .records-header { align-items: flex-start; }
  .records-header .download-btn { order: 2; width: 100%; margin-top: 8px; }
  .records-header h2 { order: 1; width: 100%; }
  .date-bar-container { gap: 6px; }
  .arrow-button { width: 36px; height: 36px; }
  .date-bar button { padding: 6px 8px; font-size: 0.95rem; }
  .stats { display: flex; flex-direction: column; gap: 12px; }
  .card { width: 100%; }
}

@media (max-width: 420px) {
  .download-btn { padding: 8px; font-size: 0.9rem; }
  .date-bar button { padding: 6px 6px; font-size: 0.85rem; }
}

/* --------------------------------------------------------------------------------------------- */

/* Center login/register pages vertically on small/medium screens when body has .auth-route */
@media (max-width: 1024px) {
  body.auth-route {
    padding-top: 0 !important;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  body.auth-route .login-container,
  body.auth-route .register-container {
    /* Prefer a viewport-relative width with a reasonable max so the
       auth card is wider on mobile but still constrained on desktop */
    width: min(96vw, 480px);
    max-width: 480px;
    margin: 0 auto;
    transform: none !important;
    position: static !important;
  }
}

/* Hide the global off-canvas overlay on auth pages to avoid the gray curtain on first load */
body.auth-route .overlay { display: none !important; }

/* Detectar dispositivos t√°ctiles/coars e y asegurar experiencia de scroll fluida.
   Esto ayuda en tablets y m√≥viles donde el gesto t√°ctil debe controlar el scroll
   del contenido principal o de contenedores horizontales. */
@media (pointer:coarse), (hover: none) {
  html, body { overflow: auto !important; -webkit-overflow-scrolling: touch; }

  /* Asegurar momentum scrolling y comportamiento predecible de overscroll */
  .content,
  .records-section .records-table,
  .date-bar,
  .chart-section,
  .sidebar {
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y;
    overscroll-behavior: contain; /* evitar el 'scroll chaining' inesperado */
  }

    /* Elementos con scroll horizontal deben permitir pan-x, pero las tablas deben
      tambi√©n permitir pan vertical para que la p√°gina pueda desplazarse cuando
      el gesto sea vertical. */
    .date-bar { touch-action: pan-x; }
    .records-section .records-table { touch-action: auto; }

  /* En dispositivos t√°ctiles preferimos que el scroll sea el del documento
     (body) para evitar scrolls anidados que generan esos "saltos" al soltar.
     Forzamos layout y content a tama√±o autom√°tico para que el body gestione el scroll. */
  .layout { height: auto !important; min-height: calc(100vh - var(--topbar-height)); display: block !important; }
  /* Algunos componentes usan .dashboard { min-height:100vh } ‚Äî anulamos eso en t√°ctil */
  .dashboard { min-height: auto !important; }

  /* Evitar que navegadores m√≥viles hagan 'zoom' al enfocar inputs peque√±os: aseguramos
    tama√±o de texto m√≠nimo en campos interactivos en dispositivos t√°ctiles */
  input, textarea, select, button { font-size: 16px !important; }
}
